<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="Zhongrui Li"><title>Design Pattern - Creational 2 · 1285 Richmond RD</title><meta name="description" content="工厂模式
实现创建者和调用者的分离
面向对象的基本设计原则，分工
OCP(open close principle): 一个软件的实体应当对扩展开发对修改关闭，添加新类来扩展功能
DIP(dependency Inversion Principle): 针对接口编程，不要针对实现编程LoD(Law "><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img border="0" src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">1285 Richmond RD</a></h3><div class="description"><p>Life is wasting time, but I don't want to stop</p></div></div></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"></a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Prowered by Hexo | Theme </a><a href="https://github.com/Ben02/hexo-theme-Anatole">Anatole</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">Home</a></li><li><a href="/about">About</a></li><li><a href="/archives">Archive</a></li><li><a href="/links">Links</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img src="/images/avatar.jpg"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>Design Pattern - Creational 2</a></h3></div><div class="post-content"><h1 id="工厂模式"><a href="#工厂模式" class="headerlink" title="工厂模式"></a>工厂模式</h1><ul>
<li>实现创建者和调用者的分离</li>
<li>面向对象的基本设计原则，分工<ul>
<li>OCP(open close principle): 一个软件的实体应当对扩展开发对修改关闭，添加新类来扩展功能</li>
<li>DIP(dependency Inversion Principle): 针对接口编程，不要针对实现编程<br>LoD(Law of Demeter): 只与你直接的朋友通信，而避免和陌生人通信</li>
</ul>
</li>
<li>分为 简单工厂模式，工厂方法模式，抽象工厂模式<ul>
<li><a href="https://github.com/godlzr/GOF23_DesignPattern/tree/master/src/com/godlzr/GOF23/factory/simpleFactory" target="_blank" rel="external">简单工厂模式</a>静态工厂，方法都是静态的， 通过接受不同参数创建不同实例， 增加新的类需要修改已有方法，扩展困难, 实际使用最多。</li>
<li><a href="https://github.com/godlzr/GOF23_DesignPattern/tree/master/src/com/godlzr/GOF23/factory/facotryMethod" target="_blank" rel="external">工厂方法模式</a>：避免了简单工厂不满足ocp的缺点，简单工厂只有一个工厂类，而工厂方法模式有一组实现了相同接口的工厂类（一般都用简单工厂模式), 不修改已有类的前提下，增加新的工厂类来实现扩展</li>
<li><a href="https://github.com/godlzr/GOF23_DesignPattern/tree/master/src/com/godlzr/GOF23/factory/abstractFactory" target="_blank" rel="external">抽象工厂模式</a>：用来生成不同产品族的全部产品， 工厂方法的升级版，不能增加产品，但能增加产品族。</li>
</ul>
</li>
</ul>
<h1 id="建造者模式"><a href="#建造者模式" class="headerlink" title="建造者模式"></a><a href="https://github.com/godlzr/GOF23_DesignPattern/tree/master/src/com/godlzr/GOF23/builder" target="_blank" rel="external">建造者模式</a></h1><ul>
<li>对象的组件多，装配顺序复杂</li>
<li>装配的问题，零件之间有一个装配顺序，分离了对象子组件的单独构造（<a href="https://github.com/godlzr/GOF23_DesignPattern/blob/master/src/com/godlzr/GOF23/builder/godlzrAirshipBuilder.java" target="_blank" rel="external">builder</a>）和装配（<a href="https://github.com/godlzr/GOF23_DesignPattern/blob/master/src/com/godlzr/GOF23/builder/godlzrAirshipDirector.java" target="_blank" rel="external">director</a>）</li>
<li>实现了构建和装配的解耦，不同的构建器，相同的装配器，构建不同的对象。相同的构建器，不同的装配器，构建不同的对象。实现了构建算法和装配算法的解耦，有很好的复用性。</li>
</ul>
<h1 id="原型模式-Prototype（克隆模式"><a href="#原型模式-Prototype（克隆模式" class="headerlink" title="原型模式 Prototype（克隆模式)"></a>原型模式 <a href="https://github.com/godlzr/GOF23_DesignPattern/tree/master/src/com/godlzr/GOF23/prototype" target="_blank" rel="external">Prototype</a>（克隆模式)</h1><ul>
<li>以某个对象为原型，复制拷贝出新的对象，实现数据的复用。新对象具备原型对象的特点。</li>
<li>优势：效率高</li>
<li>克隆类似于new，但new的对象的属性采用默认值，克隆的对象属性与原型一样。克隆的对象改变不会影响原型。例如，opencv中 mat 的clone(), copyTo().</li>
<li>有<a href="https://github.com/godlzr/GOF23_DesignPattern/blob/master/src/com/godlzr/GOF23/prototype/Sheep2.java" target="_blank" rel="external">深克隆](https://github.com/godlzr/GOF23_DesignPattern/blob/master/src/com/godlzr/GOF23/prototype/Sheep.java)浅克隆</a> 之分。 对浅克隆来说，如果对象中的某些属性也是对象，则克隆的对象与原型对象的同一个属性对象在内存中只有一个，该属性对象并没有被复制。如果修改了该属性，则无论是克隆对象和原型对象的该属性都被修改。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Sheep</span> <span class="keyword">implements</span> <span class="title">Cloneable</span></span>&#123; </span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String sname;</span><br><span class="line">	<span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> Object <span class="title">clone</span><span class="params">()</span> <span class="keyword">throws</span> CloneNotSupportedException </span>&#123;</span><br><span class="line">		Object obj = <span class="keyword">super</span>.clone();<span class="comment">//直接调用object的clone方法</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">//实现deep clone</span></span><br><span class="line">		Sheep s = (Sheep)obj;</span><br><span class="line">		s.birthday = (Date) <span class="keyword">this</span>.birthday.clone();<span class="comment">//把属性也进行克隆</span></span><br><span class="line">		<span class="keyword">return</span> obj;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>实现深克隆就要把原型对象的所有属性都复制。</li>
<li>深克隆可以利用<a href="https://github.com/godlzr/GOF23_DesignPattern/blob/master/src/com/godlzr/GOF23/prototype/Client2.java" target="_blank" rel="external">序列化和反序列化技术实现</a>.</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span>  IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">		Date date = <span class="keyword">new</span> Date(<span class="number">11123123L</span>);</span><br><span class="line">		Sheep2 s1 = <span class="keyword">new</span> Sheep2(&amp;quot;Dori&amp;quot;, date);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//使用序列化将对象输出到数据流</span></span><br><span class="line">		ByteArrayOutputStream bos = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">		ObjectOutputStream oos = <span class="keyword">new</span> ObjectOutputStream(bos);</span><br><span class="line">		oos.writeObject(s1);<span class="comment">//输出s1的拷贝</span></span><br><span class="line">		<span class="keyword">byte</span>[] bytes = bos.toByteArray();</span><br><span class="line"></span><br><span class="line">		<span class="comment">//使用反序列化将数据流中的对象读入并实现深克隆</span></span><br><span class="line">		ByteArrayInputStream bis = <span class="keyword">new</span> ByteArrayInputStream(bytes);</span><br><span class="line">		ObjectInputStream ois = <span class="keyword">new</span> ObjectInputStream(bis);</span><br><span class="line">		Sheep2 s2 = (Sheep2) ois.readObject();<span class="comment">//拷贝给s2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><a href="https://github.com/godlzr/GOF23_DesignPattern/blob/master/src/com/godlzr/GOF23/prototype/Client3.java" target="_blank" rel="external">使用情景</a>：使用new创建对象很耗时间时，利用原型模式拷贝来提高效率。</li>
<li>原型模式一般和工厂模式结合起来</li>
</ul>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2015-08-14</span><i class="fa fa-tag"></i><a href="/categories/Design-Pattern/" title="Design Pattern" class="tag">Design Pattern </a></div></div></div></div><div class="share"><div class="evernote"> <a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"> <a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"> <a href="http://twitter.com/home?status=,http://godlzr.com/2015/08/14/DesignPattern_Creational2/,1285 Richmond RD,Design Pattern - Creational 2,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a role="navigation" href="/2015/08/16/DesignPattern_Structural/" title="Design Pattern - Structural" class="btn">prev_post</a></li><li class="next pagbuttons"><a role="navigation" href="/2015/08/13/DesignPattern_Creational1/" title="Design Pattern - Creational 1" class="btn">next_post</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>