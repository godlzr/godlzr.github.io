---
title: OpenGL pipeline
id: 276
categories:
  - Computer Graphics
date: 2015-08-03 01:56:25
tags:
  - OpenGL
---
# OpenGL流水线

渲染：计算机根据模型创建图象。

_**模型**_（或物体）是由_**几何图元**_构成的，而_**几何图元**_是通过_**顶点(顶点数据)**_来指定的。可以这样理解，顶点数据即几何图元的数学表示。

最终渲染的图象由屏幕_**像素**_组成。_**像素（pixel）**_是显示硬件能够放置到屏幕上的最小的可视元素。有关像素的信息（如颜色）在系统内存中被组织为位面（bitplane）。位面构成了帧缓存（包含图形显示设备为控制屏幕上所有像素的颜色和亮度所需的信息）。

1、使用几何图元建立模型，从而得到物体的数学描述。（OpenGL将点、直线、多边形、图形和位图视为图元）；

2、在三维空间排列物体，选择观察场景的有利位置；

3、计算所有物体的颜色。颜色可能是由应用程序指定的、根据光照条件确定的、将问题粘贴到物体上得到的，也可能是上述多种操作的结果；

4、将物体的数学描述和相关的颜色信息转换为屏幕像素，这被称为**光栅化**。

当我们把绘制的图形传递给OpenGL后，OpenGL还要做许多才能完成3D空间到屏幕的投影。这一系列的过程称为OpenGL渲染流水线。一般的渲染流水线过程有如下几步： 显示列表 求值程序 顶点操作 图元装配 像素操作 纹理装配 光栅化 片断操作

[![open1](http://godlzr.com/wp-content/uploads/2015/08/open1.jpg)](http://godlzr.com/wp-content/uploads/2015/08/open1.jpg)

OpenGL pipeline 可以分为两部分，一部分是对**顶点数据(Vertex data)**的操作，另一部分是对**像素数据(Pixel data)**的操作。

1.首先，**顶点数据**和**像素数据**都可以保存在**显示列表(Display list)**当中，用来维护一定的执行顺序。

2.**求值器(Evaluators)，**将几何图元用顶点数据来表示，求值器根据顶点计算出图元的数学表达方法，多数情况下是一种多项式映射，简单的理解为一个函数表达式，可以进一步计算该图元上的某顶点的信息(表面法线，纹理坐标，颜色，空间坐标)。

3. **顶点操作**接着，对于顶点数据，可以做一系列的操作，包括几何变换，还有纹理光照等一系列的着色操作，这里就可以使用shader着色器，所以这一步也是vertex shader。然后将顶点变换为图元。

4.**图元装配(primitive assembly)，**根据一定的透视规则裁剪图元并将单个图元装配成完整的几何图元。

**像素操作(pixel operations) **即对像素做一些对应的操作.

5.像素操作之后即**纹理装配(texture assembly)**，包括一系列的纹理贴图与定位。

6.**光栅化(Rasterization)**, 将几何数据与像素数据合并转换为**片段(fragment)**，即帧缓冲中的像素， 把顶点连接起来并填充内部像素。

7.**片段操作(fragment operation)**,一系列操作（这里也可以运用shader即**fragment shader**）之后生成最终的帧，存入**帧缓冲(frame buffer)。**

简单来说，Data-->vertex shader (将数据转化为顶点)-->rasterization(连接顶点并填充三角形)-->fragment shader(根据几何图元加载颜色生成像素)-->output image(根据像素生成图片)-->在屏幕上显示